import sys, os
import ms.version
ms.version.addpkg("lxml","3.8.0")
ms.version.addpkg("elementtree","1.2")
ms.version.addpkg("BeautifulSoup","3.2.1")
ms.version.addpkg("beautifulsoup4","4.5.1")

from lxml import etree
import elementtree as ET
from bs4 import BeautifulSoup

f = open('C:/MSDE/yashleev/git/ripple/src/.idea/runConfigurations/try1.xml')
xml = f.read()
f.close()
context = etree.fromstring(xml)
elements = []

for elem in context:
    if elem.tag == 'configuration':
        #title = elem.attrib['name']
        #title = title.replace(".","_")
        #filename = format(title + ".xml")
        elements.append(elem)
#print(elements)

elements_one = elements[0]
print(elements_one)
elements_xyz = elements[1:]
print(elements_xyz)

for elem in elements_xyz:
    if elem.tag == 'configuration':
        title = elem.attrib['name']
        title = title.replace(".","_")
        filename = format(title + ".xml")
    with open(filename, 'wb') as f:
        f.write('<component name="ProjectRunConfigurationManager">\n')
        f.write(etree.tostring(elements_one))
        if elem.tag == 'configuration':
            attr = elem.attrib
            val = elem.attrib['name']
        soup = BeautifulSoup(etree.tostring(elem).decode(), "lxml")
        soup.find('configuration')['selected'] = ''
        f.write(etree.tostring(elem))
        f.write('</component>')
